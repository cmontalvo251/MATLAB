
<pre class="code" onmouseover="mcodeMouseOver(event);" onmouseout="mcodeMouseOut(event);"onclick="mcodeClick(event);">
<span class="lineno" id="1"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',1)">   1</a></span><span class="linemarker">   </span><span class="line" id="1"><span class="keyword">function</span> <span class="message fatal" id="msg1" msgid="1">rk_example</span>(<span class="var type1" id="S2T1U5">D</span>,<span class="var type1" id="S3T1U6">y0</span>,<span class="var type1" id="S4T1U7">dt</span>,<span class="var type1" id="S5T1U8">nstep</span>)</span>
<span class="lineno" id="2"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',2)">   2</a></span><span class="linemarker">   </span><span class="line" id="2"></span>
<span class="lineno" id="3"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',3)">   3</a></span><span class="linemarker">   </span><span class="line" id="3"><span class="comment">%%%Eulers' method</span></span>
<span class="lineno" id="4"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',4)">   4</a></span><span class="linemarker">   </span><span class="line" id="4"></span>
<span class="lineno" id="5"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',5)">   5</a></span><span class="linemarker">   </span><span class="line" id="5"><span class="comment">%D = 2;</span></span>
<span class="lineno" id="6"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',6)">   6</a></span><span class="linemarker">   </span><span class="line" id="6"><span class="var type0" id="S6T0U12">y</span>(1) = <span class="var type1" id="S3T1U14">y0</span>;</span>
<span class="lineno" id="7"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',7)">   7</a></span><span class="linemarker">   </span><span class="line" id="7"><span class="comment">%dt = 1.0;</span></span>
<span class="lineno" id="8"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',8)">   8</a></span><span class="linemarker">   </span><span class="line" id="8"><span class="comment">%nstep = 3;</span></span>
<span class="lineno" id="9"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',9)">   9</a></span><span class="linemarker">   </span><span class="line" id="9"></span>
<span class="lineno" id="10"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',10)">  10</a></span><span class="linemarker">   </span><span class="line" id="10"><span class="var type0" id="S7T0U17">t</span> = 0:<span class="var type2" id="S4T1U21">dt</span>:(<span class="var type2" id="S4T1U24">dt</span>*<span class="var type2" id="S5T1U25">nstep</span>);</span>
<span class="lineno" id="11"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',11)">  11</a></span><span class="linemarker">   </span><span class="line" id="11"></span>
<span class="lineno" id="12"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',12)">  12</a></span><span class="linemarker">   </span><span class="line" id="12"><span class="var type0" id="S8T0U28">a_sol</span> = <span class="var type0" id="S6T0U31">y</span>(1)*exp(-<span class="var type2" id="S2T1U37">D</span>*<span class="var type0" id="S7T0U38">t</span>);</span>
<span class="lineno" id="13"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',13)">  13</a></span><span class="linemarker">   </span><span class="line" id="13"></span>
<span class="lineno" id="14"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',14)">  14</a></span><span class="linemarker">   </span><span class="line" id="14"><span class="keyword">for</span> <span class="var type0" id="S10T0U41">n</span> = 1:<span class="var type2" id="S5T1U44">nstep</span></span>
<span class="lineno" id="15"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',15)">  15</a></span><span class="linemarker">   </span><span class="line" id="15">    <span class="var type0" id="S11T0U47">ydot</span> = -<span class="var type2" id="S2T1U50">D</span>*<span class="var type0" id="S6T0U52">y</span>(<span class="var type0" id="S10T0U53">n</span>);</span>
<span class="lineno" id="16"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',16)">  16</a></span><span class="linemarker">   </span><span class="line" id="16">    <span class="var type0" id="S6T0U57">y</span>(<span class="var type0" id="S10T0U59">n</span>+1) = <span class="var type0" id="S6T0U63">y</span>(<span class="var type0" id="S10T0U64">n</span>) + <span class="var type0" id="S11T0U66">ydot</span>*<span class="var type2" id="S4T1U67">dt</span>;</span>
<span class="lineno" id="17"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',17)">  17</a></span><span class="linemarker">   </span><span class="line" id="17"><span class="keyword">end</span></span>
<span class="lineno" id="18"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',18)">  18</a></span><span class="linemarker">   </span><span class="line" id="18"></span>
<span class="lineno" id="19"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',19)">  19</a></span><span class="linemarker">   </span><span class="line" id="19"><span class="comment">%plot(y,'LineWidth',2)</span></span>
<span class="lineno" id="20"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',20)">  20</a></span><span class="linemarker">   </span><span class="line" id="20"></span>
<span class="lineno" id="21"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',21)">  21</a></span><span class="linemarker">   </span><span class="line" id="21"><span class="var type0" id="S12T0U71">yRK2</span>(1) = 2;</span>
<span class="lineno" id="22"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',22)">  22</a></span><span class="linemarker">   </span><span class="line" id="22"></span>
<span class="lineno" id="23"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',23)">  23</a></span><span class="linemarker">   </span><span class="line" id="23"><span class="keyword">for</span> <span class="var type0" id="S10T0U76">n</span> = 1:<span class="var type2" id="S5T1U79">nstep</span></span>
<span class="lineno" id="24"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',24)">  24</a></span><span class="linemarker">   </span><span class="line" id="24">    <span class="var type0" id="S13T0U82">k1</span> = -<span class="var type2" id="S2T1U85">D</span>*<span class="var type0" id="S12T0U87">yRK2</span>(<span class="var type0" id="S10T0U88">n</span>);</span>
<span class="lineno" id="25"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',25)">  25</a></span><span class="linemarker">   </span><span class="line" id="25">    <span class="var type0" id="S14T0U91">k2</span> = -<span class="var type2" id="S2T1U94">D</span>*(<span class="var type0" id="S12T0U98">yRK2</span>(<span class="var type0" id="S10T0U99">n</span>)+<span class="var type0" id="S13T0U101">k1</span>*<span class="var type2" id="S4T1U102">dt</span>);</span>
<span class="lineno" id="26"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',26)">  26</a></span><span class="linemarker">   </span><span class="line" id="26">    <span class="var type0" id="S15T0U105">phi</span> = 0.5*(<span class="var type0" id="S13T0U110">k1</span>+<span class="var type0" id="S14T0U111">k2</span>);</span>
<span class="lineno" id="27"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',27)">  27</a></span><span class="linemarker">   </span><span class="line" id="27">    <span class="var type0" id="S12T0U115">yRK2</span>(<span class="var type0" id="S10T0U117">n</span>+1) = <span class="var type0" id="S12T0U121">yRK2</span>(<span class="var type0" id="S10T0U122">n</span>) + <span class="var type0" id="S15T0U124">phi</span>*<span class="var type2" id="S4T1U125">dt</span>;</span>
<span class="lineno" id="28"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',28)">  28</a></span><span class="linemarker">   </span><span class="line" id="28"><span class="keyword">end</span></span>
<span class="lineno" id="29"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',29)">  29</a></span><span class="linemarker">   </span><span class="line" id="29"></span>
<span class="lineno" id="30"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',30)">  30</a></span><span class="linemarker">   </span><span class="line" id="30"><span class="comment">%hold on</span></span>
<span class="lineno" id="31"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',31)">  31</a></span><span class="linemarker">   </span><span class="line" id="31"><span class="comment">%plot(yRK2,'r-','LineWidth',2)</span></span>
<span class="lineno" id="32"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',32)">  32</a></span><span class="linemarker">   </span><span class="line" id="32"></span>
<span class="lineno" id="33"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',33)">  33</a></span><span class="linemarker">   </span><span class="line" id="33"><span class="var type0" id="S16T0U129">yRK4</span>(1) = 2;</span>
<span class="lineno" id="34"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',34)">  34</a></span><span class="linemarker">   </span><span class="line" id="34"></span>
<span class="lineno" id="35"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',35)">  35</a></span><span class="linemarker">   </span><span class="line" id="35"><span class="keyword">for</span> <span class="var type0" id="S10T0U134">n</span> = 1:<span class="var type2" id="S5T1U137">nstep</span></span>
<span class="lineno" id="36"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',36)">  36</a></span><span class="linemarker">   </span><span class="line" id="36">    <span class="var type0" id="S13T0U140">k1</span> = -<span class="var type2" id="S2T1U143">D</span>*<span class="var type0" id="S16T0U145">yRK4</span>(<span class="var type0" id="S10T0U146">n</span>);</span>
<span class="lineno" id="37"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',37)">  37</a></span><span class="linemarker">   </span><span class="line" id="37">    <span class="var type0" id="S14T0U149">k2</span> = -<span class="var type2" id="S2T1U152">D</span>*(<span class="var type0" id="S16T0U156">yRK4</span>(<span class="var type0" id="S10T0U157">n</span>) + <span class="var type0" id="S13T0U160">k1</span>*<span class="var type2" id="S4T1U161">dt</span>/2);</span>
<span class="lineno" id="38"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',38)">  38</a></span><span class="linemarker">   </span><span class="line" id="38">    <span class="var type0" id="S17T0U165">k3</span> = -<span class="var type2" id="S2T1U168">D</span>*(<span class="var type0" id="S16T0U172">yRK4</span>(<span class="var type0" id="S10T0U173">n</span>) + <span class="var type0" id="S14T0U176">k2</span>*<span class="var type2" id="S4T1U177">dt</span>/2);</span>
<span class="lineno" id="39"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',39)">  39</a></span><span class="linemarker">   </span><span class="line" id="39">    <span class="var type0" id="S18T0U181">k4</span> = -<span class="var type2" id="S2T1U184">D</span>*(<span class="var type0" id="S16T0U188">yRK4</span>(<span class="var type0" id="S10T0U189">n</span>) + <span class="var type0" id="S17T0U191">k3</span>*<span class="var type2" id="S4T1U192">dt</span>);</span>
<span class="lineno" id="40"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',40)">  40</a></span><span class="linemarker">   </span><span class="line" id="40">    <span class="var type0" id="S15T0U195">phi</span> = (1/6)*(<span class="var type0" id="S13T0U205">k1</span> + 2*<span class="var type0" id="S14T0U208">k2</span> + 2*<span class="var type0" id="S17T0U211">k3</span> + <span class="var type0" id="S18T0U212">k4</span>);</span>
<span class="lineno" id="41"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',41)">  41</a></span><span class="linemarker">   </span><span class="line" id="41">    <span class="var type0" id="S16T0U216">yRK4</span>(<span class="var type0" id="S10T0U218">n</span>+1) = <span class="var type0" id="S16T0U222">yRK4</span>(<span class="var type0" id="S10T0U223">n</span>) + <span class="var type0" id="S15T0U225">phi</span>*<span class="var type2" id="S4T1U226">dt</span>;</span>
<span class="lineno" id="42"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',42)">  42</a></span><span class="linemarker">   </span><span class="line" id="42"><span class="keyword"><span class="keyword">end</span></span></span>
</pre>
