
<pre class="code" onmouseover="mcodeMouseOver(event);" onmouseout="mcodeMouseOut(event);"onclick="mcodeClick(event);">
<span class="lineno" id="1"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',1)">   1</a></span><span class="linemarker">   </span><span class="line" id="1"><span class="keyword">function</span> <span class="message fatal" id="msg1" msgid="1">rk_example</span>(D,y0,dt,nstep)</span>
<span class="lineno" id="2"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',2)">   2</a></span><span class="linemarker">   </span><span class="line" id="2"></span>
<span class="lineno" id="3"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',3)">   3</a></span><span class="linemarker">   </span><span class="line" id="3"><span class="comment">%%%Eulers' method</span></span>
<span class="lineno" id="4"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',4)">   4</a></span><span class="linemarker">   </span><span class="line" id="4"></span>
<span class="lineno" id="5"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',5)">   5</a></span><span class="linemarker">   </span><span class="line" id="5"><span class="comment">%D = 2;</span></span>
<span class="lineno" id="6"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',6)">   6</a></span><span class="linemarker">   </span><span class="line" id="6">y(1) = y0;</span>
<span class="lineno" id="7"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',7)">   7</a></span><span class="linemarker">   </span><span class="line" id="7"><span class="comment">%dt = 1.0;</span></span>
<span class="lineno" id="8"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',8)">   8</a></span><span class="linemarker">   </span><span class="line" id="8"><span class="comment">%nstep = 3;</span></span>
<span class="lineno" id="9"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',9)">   9</a></span><span class="linemarker">   </span><span class="line" id="9"></span>
<span class="lineno" id="10"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',10)">  10</a></span><span class="linemarker">   </span><span class="line" id="10">t = 0:dt:(dt*nstep);</span>
<span class="lineno" id="11"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',11)">  11</a></span><span class="linemarker">   </span><span class="line" id="11"></span>
<span class="lineno" id="12"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',12)">  12</a></span><span class="linemarker">   </span><span class="line" id="12">a_sol = y(1)*exp(-D*t);</span>
<span class="lineno" id="13"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',13)">  13</a></span><span class="linemarker">   </span><span class="line" id="13"></span>
<span class="lineno" id="14"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',14)">  14</a></span><span class="linemarker">   </span><span class="line" id="14"><span class="keyword">for</span> n = 1:nstep</span>
<span class="lineno" id="15"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',15)">  15</a></span><span class="linemarker">   </span><span class="line" id="15">    ydot = -D*y(n);</span>
<span class="lineno" id="16"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',16)">  16</a></span><span class="linemarker">   </span><span class="line" id="16">    y(n+1) = y(n) + ydot*dt;</span>
<span class="lineno" id="17"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',17)">  17</a></span><span class="linemarker">   </span><span class="line" id="17"><span class="keyword">end</span></span>
<span class="lineno" id="18"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',18)">  18</a></span><span class="linemarker">   </span><span class="line" id="18"></span>
<span class="lineno" id="19"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',19)">  19</a></span><span class="linemarker">   </span><span class="line" id="19"><span class="comment">%plot(y,'LineWidth',2)</span></span>
<span class="lineno" id="20"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',20)">  20</a></span><span class="linemarker">   </span><span class="line" id="20"></span>
<span class="lineno" id="21"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',21)">  21</a></span><span class="linemarker">   </span><span class="line" id="21">yRK2(1) = 2;</span>
<span class="lineno" id="22"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',22)">  22</a></span><span class="linemarker">   </span><span class="line" id="22"></span>
<span class="lineno" id="23"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',23)">  23</a></span><span class="linemarker">   </span><span class="line" id="23"><span class="keyword">for</span> n = 1:nstep</span>
<span class="lineno" id="24"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',24)">  24</a></span><span class="linemarker">   </span><span class="line" id="24">    k1 = -D*yRK2(n);</span>
<span class="lineno" id="25"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',25)">  25</a></span><span class="linemarker">   </span><span class="line" id="25">    k2 = -D*(yRK2(n)+k1*dt);</span>
<span class="lineno" id="26"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',26)">  26</a></span><span class="linemarker">   </span><span class="line" id="26">    phi = 0.5*(k1+k2);</span>
<span class="lineno" id="27"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',27)">  27</a></span><span class="linemarker">   </span><span class="line" id="27">    yRK2(n+1) = yRK2(n) + phi*dt;</span>
<span class="lineno" id="28"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',28)">  28</a></span><span class="linemarker">   </span><span class="line" id="28"><span class="keyword">end</span></span>
<span class="lineno" id="29"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',29)">  29</a></span><span class="linemarker">   </span><span class="line" id="29"></span>
<span class="lineno" id="30"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',30)">  30</a></span><span class="linemarker">   </span><span class="line" id="30"><span class="comment">%hold on</span></span>
<span class="lineno" id="31"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',31)">  31</a></span><span class="linemarker">   </span><span class="line" id="31"><span class="comment">%plot(yRK2,'r-','LineWidth',2)</span></span>
<span class="lineno" id="32"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',32)">  32</a></span><span class="linemarker">   </span><span class="line" id="32"></span>
<span class="lineno" id="33"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',33)">  33</a></span><span class="linemarker">   </span><span class="line" id="33">yRK4(1) = 2;</span>
<span class="lineno" id="34"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',34)">  34</a></span><span class="linemarker">   </span><span class="line" id="34"></span>
<span class="lineno" id="35"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',35)">  35</a></span><span class="linemarker">   </span><span class="line" id="35"><span class="keyword">for</span> n = 1:nstep</span>
<span class="lineno" id="36"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',36)">  36</a></span><span class="linemarker">   </span><span class="line" id="36">    k1 = -D*yRK4(n);</span>
<span class="lineno" id="37"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',37)">  37</a></span><span class="linemarker">   </span><span class="line" id="37">    k2 = -D*(yRK4(n) + k1*dt/2);</span>
<span class="lineno" id="38"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',38)">  38</a></span><span class="linemarker">   </span><span class="line" id="38">    k3 = -D*(yRK4(n) + k2*dt/2);</span>
<span class="lineno" id="39"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',39)">  39</a></span><span class="linemarker">   </span><span class="line" id="39">    k4 = -D*(yRK4(n) + k3*dt);</span>
<span class="lineno" id="40"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',40)">  40</a></span><span class="linemarker">   </span><span class="line" id="40">    phi = (1/6)*(k1 + 2*k2 + 2*k3 + k4);</span>
<span class="lineno" id="41"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',41)">  41</a></span><span class="linemarker">   </span><span class="line" id="41">    yRK4(n+1) = yRK4(n) + phi*dt;</span>
<span class="lineno" id="42"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',42)">  42</a></span><span class="linemarker">   </span><span class="line" id="42"><span class="keyword"><span class="keyword">end</span></span></span>
<span class="lineno" id="43"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',43)">  43</a></span><span class="linemarker">   </span><span class="line" id="43"></span>
<span class="lineno" id="44"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',44)">  44</a></span><span class="linemarker">   </span><span class="line" id="44"><span class="comment">%plot(yRK4,'g-','LineWidth',2)</span></span>
<span class="lineno" id="45"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',45)">  45</a></span><span class="linemarker">   </span><span class="line" id="45"></span>
<span class="lineno" id="46"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',46)">  46</a></span><span class="linemarker">   </span><span class="line" id="46"><span class="comment">%plot(a_sol,'k-','LineWidth',2)</span></span>
<span class="lineno" id="47"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',47)">  47</a></span><span class="linemarker">   </span><span class="line" id="47"></span>
<span class="lineno" id="48"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',48)">  48</a></span><span class="linemarker">   </span><span class="line" id="48"><span class="comment">%legend('RK1','RK2','RK4')</span></span>
<span class="lineno" id="49"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',49)">  49</a></span><span class="linemarker">   </span><span class="line" id="49"></span>
<span class="lineno" id="50"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',50)">  50</a></span><span class="linemarker">   </span><span class="line" id="50"><span class="comment">%ylim([0 2])</span></span>
<span class="lineno" id="51"><a href="matlab: opentoline('/home/carlos/Documents/Courses/Courses_Taught/ME228_Analysis/Lessons/RK4/rk_example.m',51)">  51</a></span><span class="linemarker">   </span><span class="line" id="51"></pre>
