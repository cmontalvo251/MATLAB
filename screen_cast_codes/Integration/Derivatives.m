function dthetadt_vec = Derivatives(theta_vec)

%theta1 = theta_vec(1);
%theta2 = theta_vec(2);
%theta3 = etc etc
P1 = 69;
P2 = 69;
P3 = 69;
P4 = 155;
C4 = 99.4;
C1 = 16.2;
C2 = 16.2;
C3 = 16.2;
G14 = 2.38;
G41 = 2.38;
G24 = 2.38;
G42 = 2.38;
G34 = 2.38;
G43 = 2.38;
G4A = 2.38;
G12 = 2.01;
G21 = 2.01;
G13 = 2.01;
G31 = 2.01;
G23 = 2.01;
G32 = 2.01;
Cmat = diag([C1,C2,C3,C4]);
thetaA = 19.5;
G11 = G12 + G13 + G14;
G22 = G21 + G23 + G24;
G33 = G31 + G32 + G34;
G44 = G41 + G42 + G43 + G4A;
Gmat = [G11,-G12,-G13,-G14;-G21,G22,-G23,-G24;-G31,-G32,G33,-G34;-G41,-G42,-G43,G44];
dthetadt_vec = inv(Cmat)*[P1;P2;P3;P4+thetaA*G4A]-inv(Cmat)*Gmat*theta_vec;